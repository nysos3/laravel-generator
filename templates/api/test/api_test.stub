<?php

namespace $NAMESPACE_API_TESTS$;

use Illuminate\Foundation\Testing\WithoutMiddleware;
use Illuminate\Foundation\Testing\DatabaseTransactions;
use $NAMESPACE_TESTS$\TestCase;
use $NAMESPACE_TEST_TRAITS$\Make$MODEL_NAME$Trait;
use $NAMESPACE_TESTS$\ApiTestTrait;

class $MODEL_NAME$ApiTest extends TestCase
{
  use AuthenticateApiTestTrait, Make$MODEL_NAME$Trait, WithoutMiddleware, ApiTestTrait, DatabaseTransactions;

  /**
   * @test
   */
  public function test_create_$MODEL_NAME_SNAKE$()
  {
    $$MODEL_NAME_CAMEL$ = $this->fake$MODEL_NAME$Data();
    $this->response = $this->actingAs($this->authData())->json('POST', '$API_PREFIX_AND_VERSION$/$MODEL_NAME_PLURAL_CAMEL$', $$MODEL_NAME_CAMEL$, ['CONTENT_TYPE' => '$API_CONTENT_TYPE$']);
    $this->json('POST', '/api/v1/$MODEL_NAME_PLURAL_CAMEL$', $$MODEL_NAME_CAMEL$);

    $this->assertApiResponse($$MODEL_NAME_CAMEL$);
  }

  /**
   * @test
   */
  public function test_read_$MODEL_NAME_SNAKE$()
  {
    $$MODEL_NAME_CAMEL$ = $this->make$MODEL_NAME$();
    $this->response = $this->actingAs($this->authData())->json('GET', '$API_PREFIX_AND_VERSION$/$MODEL_NAME_PLURAL_CAMEL$/' . $$MODEL_NAME_CAMEL$->$PRIMARY_KEY_NAME$, ['CONTENT_TYPE' => '$API_CONTENT_TYPE$']);

    $this->assertApiResponse($$MODEL_NAME_CAMEL$->toArray());
  }

  /**
   * @test
   */
  public function test_update_$MODEL_NAME_SNAKE$()
  {
    $$MODEL_NAME_CAMEL$ = $this->make$MODEL_NAME$();
    $edited$MODEL_NAME$ = $this->fake$MODEL_NAME$Data();

    $this->response = $this->actingAs($this->authData())->json('PATCH', '$API_PREFIX_AND_VERSION$/$MODEL_NAME_PLURAL_CAMEL$/' . $$MODEL_NAME_CAMEL$->$PRIMARY_KEY_NAME$, $edited$MODEL_NAME$, ['CONTENT_TYPE' => '$API_CONTENT_TYPE$']);

    $this->assertApiResponse($edited$MODEL_NAME$);
  }

  /**
   * @test
   */
  public function test_delete_$MODEL_NAME_SNAKE$()
  {
    $$MODEL_NAME_CAMEL$ = $this->make$MODEL_NAME$();
    $this->response = $this->actingAs($this->authData())->json('DELETE', '$API_PREFIX_AND_VERSION$/$MODEL_NAME_PLURAL_CAMEL$/' . $$MODEL_NAME_CAMEL$->$PRIMARY_KEY_NAME$, ['CONTENT_TYPE' => '$API_CONTENT_TYPE$']);

    $this->assertApiSuccess();
    $this->response = $this->actingAs($this->authData())->json('GET', '$API_PREFIX_AND_VERSION$/$MODEL_NAME_PLURAL_CAMEL$/' . $$MODEL_NAME_CAMEL$->$PRIMARY_KEY_NAME$, ['CONTENT_TYPE' => '$API_CONTENT_TYPE$']);

    $this->response->assertStatus(404);
  }
}
